# 项目开发建议文档

## 1. 技术选型补充建议

### 推荐明确的依赖版本：
- `expo-sqlite` → 考虑使用新版 `expo-sqlite/next`（性能更好）
- 状态管理：Zustand 是好选择，但这个项目也可以考虑 React Context + hooks（更轻量）
- 图表库：`react-native-gifted-charts` 不依赖原生模块，推荐优先使用

### 额外建议安装：
```json
{
  "@react-native-async-storage/async-storage": "轻量设置存储",
  "expo-constants": "环境变量管理",
  "expo-splash-screen": "启动页控制",
  "date-fns": "日期处理（比 moment 轻）"
}
```

## 2. 开发流程优化

### 建议的开发顺序调整：
1. **先做数据层 + 本地存储**（C部分）
   - 这是核心，先确保数据不丢
2. **再做 Home 页基础功能**（快速记录 + 今日进度）
   - 尽早跑通核心流程
3. **然后做通知**（E部分）
   - 这是第二核心功能
4. **最后做统计和历史**（Stats/History）
   - 锦上添花的部分

**原因：** 这样你能更早看到可用的 MVP，有成就感，也便于测试核心逻辑。

## 3. 需要注意的坑

### 通知相关
- **iOS 真机测试必须**：iOS 模拟器不支持通知，必须用真机测试
- **Android 13+ 权限**：需要额外请求 `POST_NOTIFICATIONS` 权限
- **通知限制**：iOS 最多 64 个待发通知，Android 无此限制但要注意电池优化

### SQLite 注意事项
- **日期存储**：统一用 ISO 8601 格式 (`YYYY-MM-DD`)
- **时区问题**：建议所有 timestamp 都存 UTC，展示时转本地时区
- **数据迁移**：一开始就写好 migration 逻辑，后面加字段会轻松很多

### 上架前必做
- **隐私政策页面**：即使不收集数据也要有，可以放在 Settings 里
- **健康免责声明**：建议首次启动时弹窗展示一次
- **测试数据清理**：上架前确保没有测试数据和 console.log

## 4. 功能优先级建议

### MVP 可以砍掉的：
- 7日趋势图 → 先做简单的列表展示即可
- 历史日历 → V1.1 再做
- 自定义容量 → 先只做预设按钮（200ml / 300ml / 500ml）

### 一定要有的：
- ✅ 今日进度环形图（视觉核心）
- ✅ 快捷记录按钮
- ✅ 通知设置
- ✅ 撤销删除（用户体验关键）

## 5. UX 细节建议

### 交互优化：
- 记录饮水后给触觉反馈（Haptics）
- 达到目标时播放庆祝动画
- 通知文案要友好（"该喝水啦 💧" 而不是冷冰冰的提醒）

### 数据展示：
- 进度百分比要大而明显
- 还差多少比已喝多少更重要（心理学）
- 考虑加入"连续打卡天数"（增加粘性）

### 错误处理：
- 数据库初始化失败要有降级方案
- 通知权限被拒要有引导说明
- 离线状态提示（虽然本来就离线）

## 6. 上架准备 Checklist

### 提前准备的素材：
- App 图标：1024x1024（圆角由系统处理）
- 启动页：可以用 Expo 默认，或简单的纯色 + Logo
- 截图：
  - iOS: 至少 2 张（6.7" 和 5.5"）
  - Android: 至少 2 张（手机 + 平板可选）

### 文案准备：
- App 名称（建议简短，10 字符内）
- 副标题（iOS，30 字符）
- 简短描述（80 字符）
- 详细描述（4000 字符内）
- 关键词（iOS，100 字符，逗号分隔）

### 合规文档：
- 隐私政策 URL（可以用 GitHub Pages 托管一个静态页）
- 支持 URL（邮箱或简单的表单）

## 7. 性能目标

### 建议的性能指标：
- 冷启动 < 1.5s（不是 2s，要留 buffer）
- 记录饮水响应 < 100ms
- SQLite 查询 < 50ms（即使有 10000 条记录）
- App 包体积 < 15MB（Expo 默认会有点大，需要优化）

## 8. 测试策略

### 建议的测试场景：
1. **时区切换**：改系统时区看数据是否正确
2. **时间跨越**：跨天、跨周测试统计
3. **大量数据**：手动插入 1000 条记录测试性能
4. **权限拒绝**：拒绝通知权限后的降级体验
5. **后台唤醒**：从通知点击进入 App

## 9. 可选的增强点（V1.1+）

如果 MVP 做得快，可以考虑：
- **桌面小组件**：iOS 14+ / Android 12+
- **Siri Shortcuts**："嘿 Siri，记录喝水"
- **Apple Watch 配套**（需要额外开发）
- **数据可视化优化**：月度报告、趋势分析
- **社交功能**：分享今日成就到朋友圈（带图片）

## 10. 我的建议优先级

### 立即做：
1. 确认 Node/Expo 环境正常 ✅
2. 跑通 `npx create-expo-app` ✅
3. 优先完成数据层（SQLite CRUD）
4. 做一个最简单的"记录 + 展示"闭环

### 第二阶段：
5. 加通知功能
6. 美化 UI
7. 真机测试（iOS + Android）

### 最后：
8. 准备上架素材
9. 填写商店表单
10. 提交审核

---

## 关于 npm 警告的说明

创建项目时出现的这些警告可以安全忽略：
- `inflight@1.0.6` deprecated
- `rimraf@3.0.2` deprecated
- `glob@7.2.3` deprecated

这些是 Expo 的间接依赖产生的，Expo 团队会在未来版本中更新。只要 `found 0 vulnerabilities` 就没问题。
